<!DOCTYPE html>
<html>
    <html lang="en"></html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>
            <%= it.topicList[0].forumName %>        
        </title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <base href="https://www.nmbxd1.com" />
        <link rel="stylesheet" href="<%= it.contextPath %>/src/templates/common.css" />
        <link rel="stylesheet" href="<%= it.contextPath %>/src/templates/topicList.css" />
    </head>
<body>
    <div class="forum">
    <!-- 标题 -->
    <div class="topic-header">
        <h1><a href="/f/<%= it.topicList[0].forumName %>"><%= it.topicList[0].forumName %></a></h1>
        <!-- <img src="{{authorAvatar}}" alt="avatar" /> -->
    </div>

    <% for (const topic of it.topicList){ %>
        <div class="topic">
            <!-- 作者、时间、帖子号 --> 
            <div class="topic-meta">
                <!-- <div class="node"> -->
                    <span class="userHash"><%= topic.userHash %></span>
                    <span class="topicId">No.<%= topic.id %></span>
                    <span class="forumName"><%= it.topicList[0].forumName %></span>
                    <a class="open" href="javascript:;" onclick="vsPostMessage('topicOpen', {topic:<%= JSON.stringify(topic) %>});">打开</a>
                    <span class="collect">收藏</span>
                    <span class="share">分享</span>
                    <span class="cite"> 引用</span>
                    <span class="time"><%= topic.now %></span>
                    <!-- <a style="margin-left: 10px" href="/t/<%= topic.id %>">浏览器中打开</a> -->
                <!-- </div> -->
            </div>
            
            <!-- 正文 -->
            <div class="content">
                <% if (topic.img) { %>
                <div class="img-content"><img src="<%= it.imageUrlBase+ "thumb/" + topic.img + topic.ext %>" alt="image" /></div>
                <% } %>
                <% if (topic.content) { %>
                <div class="word-content" style="margin-bottom: 10px"><%~ topic.content %></div>
                <% } else { %>
                <div class="word-content" style="margin-bottom: 10px"></div>
                <% } %>
            </div>

            <% if (topic.replyCount) { %>
                <h2>共<%= topic.replyCount %>条回复</h2>
            <% } else { %>
                <h2>暂无回复</h2>
            <% } %>



            <!-- 评论 -->
            <div class="reply">

                <!-- 列表 -->
                <% for (const reply of topic.replies){ %>
                    <div class="reply-item">
                        <!-- 作者、时间、帖子号 --> 
                        <div class="topic-meta">
                            <div class="userHash"><%= reply.userHash %></div>
                            <div class="topicId">No.<%= reply.id %></div>
                            <% if(reply.userHash === it.topicList.userHash){ %>
                                <div class="replyAuthor">楼主</div>
                            <% } %>
                            <div class="time"><%= reply.now %></div>
                            <!-- <a class="node" href="/t/{{ reply.id }}">浏览器中打开</a> -->
                        </div>
                        
                        <!-- 正文 -->
                        <% if (reply.content) { %>
                        <div class="word-content"><%~ reply.content %></div>
                        <% } else { %>
                        <div class="word-content"></div>
                        <% } %>
                    
                    </div>
                    <% if (reply!=topic.replies[topic.replies.length-1]){ %>
                        <hr />
                    <% } %>
                <% } %>
            </div>
        </div>

    <% } %>
    </div>
    <script src="<%= it.contextPath %>/src/templates/topicList.js"></script>

</body>
</html>